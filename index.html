<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Test</title>
<style>
  body { background:#000; display:flex; flex-direction:column; align-items:center; justify-content:center; min-height:100vh; padding:20px; font-family:sans-serif; }
  button { width:100%; padding:30px; font-size:20px; font-weight:bold; border-radius:16px; border:none; margin-bottom:20px; cursor:pointer; }
  .b1 { background:#e8ff57; color:#000; }
  .b2 { background:#ff4444; color:#fff; }
  .b3 { background:#4444ff; color:#fff; }
  #log { background:#111; color:#0f0; font-family:monospace; font-size:14px; padding:20px; border-radius:12px; width:100%; min-height:150px; line-height:2; white-space:pre-wrap; }
</style>
</head>
<body>

<button class="b1" onclick="testJS()">1. TEST JAVASCRIPT</button>
<button class="b2" onclick="testMic()">2. TEST MICRÓFONO</button>
<button class="b3" onclick="testVoz()">3. TEST VOZ</button>

<div id="log">Pulsa los botones...\n</div>

<script>
function add(msg) {
  document.getElementById('log').textContent += msg + '\n';
}

function testJS() {
  add('✓ JavaScript funciona OK');
  alert('JavaScript funciona!');
}

function testMic() {
  add('→ Pidiendo micrófono...');
  if (!navigator.mediaDevices) {
    add('✗ mediaDevices NO existe');
    add('  Causa probable: no es HTTPS');
    return;
  }
  navigator.mediaDevices.getUserMedia({audio:true})
    .then(s => {
      add('✓ MICRÓFONO CONCEDIDO');
      s.getTracks().forEach(t=>t.stop());
    })
    .catch(e => {
      add('✗ Error: ' + e.name);
      add('  ' + e.message);
    });
}

function testVoz() {
  add('→ Probando SpeechRecognition...');
  const SR = window.SpeechRecognition || window.webkitSpeechRecognition;
  if (!SR) { add('✗ SpeechRecognition NO existe'); return; }
  add('✓ SpeechRecognition existe');
  const r = new SR();
  r.lang = 'es-ES';
  r.onstart = () => add('✓ GRABANDO - HABLA AHORA');
  r.onresult = e => add('✓ Texto: ' + e.results[0][0].transcript);
  r.onerror = e => add('✗ Error: ' + e.error);
  r.onend = () => add('→ Fin grabación');
  try { r.start(); add('→ start() OK'); }
  catch(e) { add('✗ start() falló: ' + e.message); }
}
</script>
</body>
</html>
